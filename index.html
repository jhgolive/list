<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Schedule API</title>
<script>
async function run() {
  alert("111");
  const params = new URLSearchParams(window.location.search);
  const date = params.get("d"); // 예: 1009
  if (!date) {
    document.body.innerText = "날짜 없음";
    return;
  }

  const formatted = date.slice(0,2) + "-" + date.slice(2);
  const url = "https://kukmin.libertysocial.co.kr/assembly?tab=list&date=2025-" + formatted;

  const html = await fetch(url).then(r => r.text());
  const text = html.replace(/<[^>]+>/g, " ").replace(/\s+/g, " ").trim();

  // 일정 부분만 간략히 추출 (필요시 조정)
  const match = text.match(/(집회|모임|일정)[^]+?(?=등록|Copyright|KUKMIN)/);
  document.body.innerText = match ? match[0].substring(0, 400) : "해당 날짜 일정 없음";
}
run();
</script>
</head>
<body>로딩중...</body>
</html>
